{% extends 'base.html' %}
{% load pinyin_filters %}

{% block title %}–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: {{ query }}{% endblock %}

{% block content %}
<div class="card">
    <h1>üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h1>

    <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
    <form method="get" action="{% url 'dictionary:search' %}" style="margin-bottom: 2rem;">
        <div style="display: flex; gap: 10px;">
            <input type="text" name="q" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞..."
                   value="{{ query }}" style="flex: 1; padding: 12px; border: 2px solid #c62828; border-radius: 8px;">
            <select name="type" style="padding: 12px; border: 2px solid #c62828; border-radius: 8px;">
                <option value="ru-zh" {% if search_type == 'ru-zh' %}selected{% endif %}>–†—É—Å—Å–∫–∏–π ‚Üí –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                <option value="zh-ru" {% if search_type == 'zh-ru' %}selected{% endif %}>–ö–∏—Ç–∞–π—Å–∫–∏–π ‚Üí –†—É—Å—Å–∫–∏–π</option>
            </select>
            <button type="submit" class="btn">–ù–∞–π—Ç–∏</button>
        </div>
    </form>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    {% if query %}
        <div style="margin-bottom: 1rem;">
            <p>
                –ù–∞–π–¥–µ–Ω–æ —Å–ª–æ–≤: <strong>{{ results_count }}</strong>
                {% if search_type == 'ru-zh' %}
                    –ø–æ –∑–∞–ø—Ä–æ—Å—É "{{ query }}" (—Ä—É—Å—Å–∫–∏–π ‚Üí –∫–∏—Ç–∞–π—Å–∫–∏–π)
                {% else %}
                    –ø–æ –∑–∞–ø—Ä–æ—Å—É "{{ query }}" (–∫–∏—Ç–∞–π—Å–∫–∏–π ‚Üí —Ä—É—Å—Å–∫–∏–π)
                {% endif %}
            </p>
        </div>
    {% endif %}

    <!-- –°–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div class="search-results">
        {% for word in results %}
        <div class="word-result" style="border-left: 4px solid #c62828; padding: 1rem; margin-bottom: 1rem; background: #f8f9fa; border-radius: 0 8px 8px 0;">
            <div style="display: flex; justify-content: space-between; align-items: start; gap: 1rem;">
                <div style="flex: 1;">
                    <h3 style="margin: 0 0 0.5rem 0; color: #c62828;">
                        <a href="{% url 'dictionary:word_detail' word.id %}" style="color: inherit; text-decoration: none;">
                            {{ word.russian }}
                        </a>
                    </h3>
                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem; font-weight: bold;">
                        {{ word.chinese_simplified|colorize_characters:word.pinyin }}
                    </div>
                    <div style="margin-bottom: 0.5rem; font-size: 1.1rem; min-height: 30px;">
                        {{ word.pinyin|colorize_pinyin }}
                    </div>
                    <div style="display: flex; gap: 1rem; font-size: 0.9rem; color: #888;">
                        <span>{{ word.get_part_of_speech_display }}</span>
                        <span>HSK {{ word.hsk_level }}</span>
                    </div>
                </div>
                <a href="{% url 'dictionary:word_detail' word.id %}" class="btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
            </div>
        </div>
        {% empty %}
        {% if query %}
        <div style="text-align: center; padding: 2rem; color: #666;">
            <p>üòî –ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞</p>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}